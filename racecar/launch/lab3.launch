<launch>
	<group ns="racecar">
		<arg name="racecar_version" default="racecar-v2" />
		<arg name="run_camera" default="false"/>

		<group ns="vesc">
		<!-- start electronic speed controller driver -->
		<include file="$(find racecar)/launch/includes/$(arg racecar_version)/vesc.launch.xml" >
		  <arg name="racecar_version" value="$(arg racecar_version)" />
		</include>
		</group>

		<!-- start imu and laser scanner -->
		<include file="$(find racecar)/launch/includes/common/sensors.launch.xml" >
		<arg name="racecar_version" value="$(arg racecar_version)" />
		</include>

		<!-- static transforms, e.g. base_link to imu -->
		<include file="$(find racecar)/launch/includes/$(arg racecar_version)/static_transforms.launch.xml" />

		<node pkg="racecar" name="scan_processor" type="scan_processor.py" />
		
		<node pkg="sensor_processing" name="wall_detector" type="wall_detector.py" output="screen"/>
		
		<node pkg="drive_control" name="drive_control" type="drive_control.py" output="screen" />
		
		<node pkg="drive_control" name="servo_commands" type="servo_commands.py" />

		<node pkg="obstacle_detection" name="obstacle_detection" type="obstacle_ahead_simple.py" >
			<param name="topic_pointcloud" value="point_cloud"/>
			<param name="topic_output" value="obstacle_distance"/>
			<param name="detection_zone" value="0.5"/>
		</node>

	</group>
</launch>